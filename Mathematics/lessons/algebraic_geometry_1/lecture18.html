 In the previous lecture, we have defined tangent spaces for affine algebraic sets and for general cases. Now we want to prove check that two definitions are identical in affine cases. Recall two definitions 
<blockquote class="thm"><b>Definition 1 (Affine Cases)</b>  	Let $latex { f\in k [x_1,\dots,x_n] }$ and $latex { p\in \mathbb{A}^n }$, the differential of $latex { f }$ at $latex { p }$ is 	<p align=center>$latex \displaystyle  	\mathrm{d}_pf=\sum\limits_{i=1}^n\frac{\partial f}{\partial x_i}(p)\cdot x_i. 	$</p>
 	Let $latex { X\subset \mathbb{A}^n }$ be an affine algebraic set. The tangent space to $latex { X }$ at $latex { p\in X }$ is 	<p align=center>$latex \displaystyle  	t_p(X)=Z(\mathrm{d}_pf|f\in I(X)). 	$</p>
 </blockquote>

<p>

 
<blockquote class="thm"><b>Definition 2 (General Cases)</b>  	Let $latex { X }$ be a variety, $latex { p\in X }$ be a point. The tangent space $latex { T_p(X) }$ is 	<p align=center>$latex \displaystyle  	T_p(X):=(\mathfrak{m}_p/\mathfrak{m}_p^2)^{\ast} 	$</p>
 	where $latex { \mathfrak{m}_p }$ is the maximal ideal of the local ring $latex { \mathcal{O}_{X,p} }$, the symbol $latex { \ast }$ denotes the dual of vector space. In other words, 	<p align=center>$latex \displaystyle  	T_p(X)=\lbrace k \text{ linear maps }\nu: \mathfrak{m}_p/\mathfrak{m}_p^2\rightarrow k \rbrace 	$</p>
 	or 	<p align=center>$latex \displaystyle  	T_p(X)=\lbrace k \text{ linear maps }\nu: \mathfrak{m}_p\rightarrow k \text{ with } \nu|_{\mathfrak{m}_p^2}=0 \rbrace. 	$</p>
 </blockquote>

<p>

 For the moment, let $latex { X\subset \mathbb{A}^n }$ be an affine variety. 
<blockquote class="thm"><b>Definition 3</b>  	If $latex { f\in A(X) }$, $latex { a=(a_1,\dots,a_n)\in t_p(X) }$, we define 	<p align=center>$latex \displaystyle  	\mathrm{d}_pf(a):=\mathrm{d}_pF(a) 	$</p>
 	where $latex { [F]=f }$, $latex { f\in k[x_1,\dots,x_n] }$ and $latex { \mathrm{d}_pF(a)=\sum\limits_{i}^n \frac{\partial F}{\partial x_i}(p)\cdot a_i }$. 	 	If $latex { h=\frac{f}{g}\in \mathrm{p} }$, then $latex { f,g\in A(X) }$, $latex { g(p)\neq 0 }$ and $latex { f(p)=0 }$. We define 	<p align=center>$latex \displaystyle  	\mathrm{d}_ph(a)=\frac{\mathrm{d}_pf(a)}{g(p)}. 	$</p>
 	Thus for $latex { a\in t_p(X) }$, we have defined a linear map 	<p align=center>$latex \displaystyle  	\partial_a:\mathfrak{m}_p/\mathfrak{m}_p^2\rightarrow k. 	$</p>
 	We define a linear map 	<p align=center>$latex \displaystyle  	\delta: t_p(X)\rightarrow T_p(X). 	$</p>
 </blockquote>

<p>

 If we can prove $latex { \delta }$ is an isomorphism, then we can identify two definitions. 
<blockquote class="thm"><b>Theorem 4</b>  	

<ol> 			<li> $latex { \delta }$ is an isomorphism. 			<li> Usinng $latex { \delta }$ to identify $latex { t_p(X) }$ and $latex { T_p(X) }$, the two definitions of $latex { \mathrm{d}_p\varphi }$ for morphism $latex { \varphi :X\rightarrow Y }$ are identified. 	
</ol>

 </blockquote>

<p>

 <em>Proof:</em>  	Let $latex { p\in X\subset\mathbb{A}^n }$, $latex { t_i:=[x_i-p_i]\in \mathfrak{m}_p }$ 	 	Injectivity: For any $latex { a\in t_p(X) }$, we have $latex { \delta (a)=\partial_a }$, it is easy to check that $latex { \partial_a(t_i)=a_i }$. If $latex { \partial_a=0 }$, then $latex { a_i=0 }$ for $latex { i=1,\dots,n }$, then $latex { a=0 }$. Hence $latex { \delta }$ is injective. 	 	Surjectivity: To show surjectivity, it is enough to show $latex { t_1,\dots,t_n }$ generate $latex { \mathfrak{m}_p/\mathfrak{m}_p^2 }$ as a vector space over $latex { k }$, If it is true , then for any $latex { \nu:\mathfrak{m}_p/\mathfrak{m}_p^2\rightarrow k }$ let $latex { a_i=\nu(t_i) }$, we get $latex { \nu=\delta(a) }$ where $latex { a=(a_1,\dots,a_n) }$, and it is easy to check that $latex { a\in t_p(X) }$. Now let's prove that $latex { t_1,\dots,t_n }$ generate $latex { \mathfrak{m}_p/\mathfrak{m}_p^2 }$. For $latex { f=\frac{g}{h}\in \mathfrak{m}_p }$, $latex { f-\frac{g}{h(p)}=\frac{g\cdot(h(p)-h)}{h\cdot h(p)}\in \mathfrak{m}_p^2 }$, thus $latex { f=\frac{g}{h(p)} }$ in $latex { \mathfrak{m}_p/\mathfrak{m}_p^2 }$. Since $latex { \frac{g}{h(p)}\in A(X) }$, we know that $latex { \mathfrak{m}_p/\mathfrak{m}_p^2 }$ is generated by elements in $latex { A(X) }$.Then $latex { \mathfrak{m}_p/\mathfrak{m}_p^2 =k[t_1,\dots,t_n]}$. For monomials of degree larger than 2 in $latex { t_i }$, it lies in $latex { \mathfrak{m}_p^2 }$. Thus $latex { \mathfrak{m}_p/\mathfrak{m}_p^2 }$ is a vector space generated by $latex { t_1,\dots,t_n }$. $latex \Box$

 
<blockquote class="thm"><b>Theorem 5</b>  	Let $latex { X }$ be a variety: 	

<ol> 		<li> $latex { X_{\mathrm{reg}} }$ is an open dense subset of $latex { X }$; 		<li> for all $latex { p\in X }$, $latex { \mathrm{dim}T_pX\geq \mathrm{dim}X }$. 	
</ol>

 </blockquote>

<p>

 <em>Proof:</em>  	Any variety $latex { X }$ has an open cover by affine varieties. The theorem is true if it is true for each open set in the cover. Thus we can assume $latex { X\subset\mathbb{A}^n }$ is a closed subvariety. Let $latex { I(X)=\langle f_1,\dots,f_r\rangle }$, $latex { f_i\in k[x_1,\dots,x_n] }$. Then we get 	<p align=center>$latex \displaystyle  	\mathrm{dim}T_p(X)= n- \mathrm{rank}(J(f_1,\dots,f_r)(p)). 	$</p>
 	this formula implies that $latex { \mathrm{dim}T_p(X)\geq d }$ if and only if all the $latex { n-d+1 }$ minors are equal to $latex { 0 }$. 	Thus for all $latex { d }$, $latex { X_d:=\lbrace p\in X|\mathrm{dim}T_pX\geq d\rbrace }$ is closed in $latex { X }$. Then we get a chain 	<p align=center>$latex \displaystyle  	X_0\supset X_1\supset \dots\supset X_d\supset X_{d+1}\supset. 	$</p>
 	Choose the largest $latex { d }$ such that $latex { X_d=X }$ and put $latex { X^0:=X\backslash X_{d+1} }$. $latex { X^0 }$ is open and dense in $latex { X }$. Then we know $latex { \mathrm{dim}T_p(X)\geq d }$ for all $latex { p\in X }$ and $latex { \mathrm{dim}T_p(X)=d }$ for all $latex { p\in X^0 }$. Now we only have to show $latex { d=\mathrm{dim}(X) }$. Since $latex { X }$ is birational to a hypersurface $latex { Y }$ in $latex { \mathbb{A}^{\mathrm{dim}(X)+1} }$, there is a nonempty open subset $latex { U\subset X }$ that is isomorphic to an open subset of $latex { Y_{\mathrm{reg}} }$. Then $latex { \mathrm{dim}T_p(X)=\mathrm{dim}X }$ for all $latex { p\in U }$. Thus for all $latex { p\in X^0\cap U }$, $latex { \mathrm{dim}X=\mathrm{dim}T_p(X)=d }$. Thus $latex { \mathrm{dim}X=d }$. $latex \Box$

 
<blockquote class="thm"><b>Corollary 6</b>  	

<ol> 		<li> Let $latex { X\subset\mathbb{A}^n }$ be an affine variety, $latex { I(X)=\langle f_1,\dots,f_r\rangle }$.Then the following is equivalent: 		<p align=center> 			$latex { p\in X }$ is nonsingular $latex { \Leftrightarrow }$ $latex { \mathrm{rank}(J(f_1,\dots,f_r)(p))\geq n-\mathrm{dim}X }$. 		</p> 		<li> Let $latex { X\subset\mathbb{P}^n }$ be a projective variety. Assume $latex { I(X)=\langle F_1,\dots,F_r\rangle }$, where $latex { F_1,\dots,F_r }$ are homogeneous. Then the following is equivalent: 		<p align=center> 			$latex { p\in X }$ is nonsingular $latex { \Leftrightarrow }$ $latex { \mathrm{rank}(J(F_1,\dots,F_r)(p))\geq n-\mathrm{dim}X }$. 		</p> 	
</ol>

 </blockquote>

<p>

 <em>Proof:</em>  	The first term is obvious. To get the second term, assume $latex { p\in U_0\cap X }$, i.e. $latex { p }$ can be written as $latex { [1,a_1,\dots,a_n] }$. Then $latex { p }$ is nonsingular if and only if $latex { a=(a_1,\dots,a_n) }$ is nonsingular in $latex { U_0\cap X }$. Let $latex { f_i(x_1,\dots,x_n)=F(1,x_1,\dots,x_n) }$ for $latex { i=1,\dots,n }$. Via the first term we only need to show that the rank of $latex { J(F_1,\dots,F_r) }$ is equal to the rank of $latex { J(f_1,\dots,f_r) }$ at $latex { p }$. By definition we know 	<p align=center>$latex \displaystyle  	J(F_1,\dots,F_r)(p)=\left( \left.\begin{array}{c} 	\frac{\partial F_1}{\partial x_0}(p) \\ 	\vdots\\ 	\frac{\partial F_r}{\partial x_0}(p) 	\end{array}\right| J(f_1,\dots,f_r)(a) \right). 	$</p>
 	By Euler formula for homogeneous polynomial $latex { F_i }$ of degree $latex { d_i }$, we have 	<p align=center>$latex \displaystyle  	\sum\limits_{j=0}^n x_i\frac{\partial F_i}{\partial x_j}= d_iF_i. 	$</p>
 	Then we get 	<p align=center>$latex \displaystyle  	\frac{\partial F_i}{\partial x_0}(p)=-\sum\limits_{j=1}^n a_i\frac{\partial f_i}{\partial x_j}(a). 	$</p>
 	So the first column of $latex { J(F_1,\dots,F_r)(p) }$ is the linear combination of other columns, i.e. $latex { J(F_1,\dots,F_r)(p)=J(f_1,\dots,f_r)(a) }$. $latex \Box$

 
<blockquote class="thm"><b>Lemma 7 (Nakayama)</b>  	Let $latex { A }$ be a local ring and $latex { \mathfrak{m}\subset A }$ be its maximal ideal. Let $latex { M }$ be a finitely generated $latex { A }$-module: 	

<ol> 		<li> if $latex { M=\mathfrak{m}M }$, then $latex { M=\lbrace 0 \rbrace }$; 		<li> write $latex { k=A/\mathfrak{m} }$, let $latex { f_1,\dots,f_r\in M }$ such that $latex { \bar{f_1},\dots,\bar{f_r} }$ generate $latex { M/\mathfrak{m}M }$ as $latex { k }$-vector space. Then $latex { f_1,\dots,f_r }$ generate $latex { M }$ as an $latex { A }$-module. 	
</ol>

 </blockquote>

<p>

 <em>Proof:</em>  	(1) Assume $latex { M\neq \lbrace 0 \rbrace }$, let $latex { \lbrace u_1,\dots,u_r\rbrace }$ be a minimal set of generators of $latex { M }$ as an $latex { A }$-module. Note $latex { u_r\in M=\mathfrak{m}M }$ i.e. 	<p align=center>$latex \displaystyle  	u_r=\sum\limits_{i=1}^{r}m_iu_i 	$</p>
 	where $latex { m_i\in \mathfrak{m} }$. Then we get 	<p align=center>$latex \displaystyle  	(1-m_r)u_r=\sum\limits_{i=1}^{r-1}m_iu_i. 	$</p>
 	Since $latex { 1-m_r }$ is a unit(if not, then $latex { 1-m_r \in \mathfrak{m} }$, $latex { 1=1-m_r+m_r\in \mathfrak{m} }$), we get 	<p align=center>$latex \displaystyle  	u_r=\sum\limits_{i=1}^{r-1}m_i(1-m_r)^{-1}u_i. 	$</p>
 We get a contradiction, thus $latex { M=\lbrace 0 \rbrace }$. $latex \Box$

 